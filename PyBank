import os
import csv


# input and ouptut files
ifile = "03-Python_hw_Instructions_PyBank_Resources_budget_data.csv"
ofile = "PyBank.txt"


# variables
total_months = 0
month_of_change = []
revenue_change_list = []
greatest_increase = 0
greatest_increase_month = ""
greatest_decrease = 0
greatest_decrease_month = ""
total_revenue = 0


#opening and reading csv
with open(ifile, encoding='utf-8') as inputfile: 
	reader = csv.DictReader(inputfile)

		# Extract first row to avoid appending to revenue_change_list
	first_row = next(reader)
	total_months = total_months + 1
	total_revenue = total_revenue + int(first_row["Profit/Losses"])
	prev_revenue = int(first_row["Profit/Losses"])

	for row in reader:
		#The total number of months included in the dataset
		total_months = total_months + 1
		#The net total amount of "Profit/Losses" over the entire period
		total_revenue = total_revenue + int(row["Profit/Losses"])
		#Calculate the changes in "Profit/Losses" over the entire period, then find the average of those changes
		revenue_change = int(row["Profit/Losses"]) - prev_revenue
		prev_revenue = int(row["Profit/Losses"])
		revenue_change_list = revenue_change_list + [revenue_change]
		#The greatest increase in profits (date and amount) over the entire period
		if revenue_change > greatest_increase:
			greatest_increase = revenue_change
			greatest_increase_month = row["Date"]


		#The greatest decrease in losses (date and amount) over the entire period
		if revenue_change < greatest_decrease:
			greatest_decrease = revenue_change
			greatest_decrease_month = row["Date"]

average_change = sum(revenue_change_list) / len(revenue_change_list)

print("Financial Analysis")
print("----------------------------")
print("Total Months: " + str(total_months))
print("Total: $" + str(total_revenue))
print("Average Change: $" + str(average_change))
print("Greatest Increase in Profits: " + str(greatest_increase_month) + " $(" + str(greatest_increase) + ")")
print("Greatest Decrease in Profits: " + str(greatest_decrease_month) + " $(" + str(greatest_decrease) + ")")
